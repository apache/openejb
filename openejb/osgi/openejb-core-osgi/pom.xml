<?xml version="1.0" encoding="UTF-8"?>
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements. See the NOTICE file distributed with
    this work for additional information regarding copyright ownership. The
    ASF licenses this file to You under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance with the
    License. You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable
    law or agreed to in writing, software distributed under the License is
    distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied. See the License for the specific
    language governing permissions and limitations under the License.
-->

<!-- $Rev$ $Date$ -->

<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <parent>
    <artifactId>osgi</artifactId>
    <groupId>org.apache.openejb</groupId>
    <version>4.5.2-SNAPSHOT</version>
  </parent>
  <modelVersion>4.0.0</modelVersion>
  <artifactId>openejb-core-osgi</artifactId>
  <packaging>bundle</packaging>
  <name>OpenEJB :: OSGi :: Core</name>
  <dependencies>
    <dependency>
      <groupId>org.apache.openejb</groupId>
      <artifactId>openejb-core</artifactId>
      <version>${project.version}</version>
    </dependency>
    <dependency>
      <groupId>org.apache.openejb</groupId>
      <artifactId>openejb-jpa-integration</artifactId>
      <version>${project.version}</version>
    </dependency>
    <dependency>
      <groupId>org.osgi</groupId>
      <artifactId>org.osgi.core</artifactId>
      <optional>true</optional>
    </dependency>
    <dependency>
      <groupId>org.osgi</groupId>
      <artifactId>org.osgi.compendium</artifactId>
      <optional>true</optional>
    </dependency>
    <dependency>
      <groupId>org.apache.geronimo.components</groupId>
      <artifactId>geronimo-transaction</artifactId>
      <optional>true</optional>
    </dependency>
    <dependency>
      <groupId>org.apache.xbean</groupId>
      <artifactId>xbean-bundleutils</artifactId>
      <version>${xbeanVersion}</version>
      <optional>true</optional>
    </dependency>
  </dependencies>
  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-shade-plugin</artifactId>
        <version>2.0</version>
        <executions>
          <execution>
            <phase>package</phase>
            <goals>
              <goal>shade</goal>
            </goals>
            <configuration>
              <artifactSet>
                <includes>
                  <include>org.apache.openejb:openejb-core</include>
                  <include>org.apache.openejb:openejb-jpa-integration</include>
                </includes>
              </artifactSet>
              <filters>
                <filter>
                  <artifact>org.apache.openejb:openejb-core</artifact>
                  <includes>
                    <include>**</include>
                  </includes>
                  <excludes>
                    <exclude>org/apache/openejb/client/**</exclude>
                    <exclude>org/openejb/client/**</exclude>
                  </excludes>
                </filter>
              </filters>
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.apache.felix</groupId>
        <artifactId>maven-bundle-plugin</artifactId>
        <extensions>true</extensions>
        <configuration>
          <instructions>
            <Bundle-Name>Apache ${project.name}</Bundle-Name>
            <Bundle-Activator>${openejb.bundle.activator}</Bundle-Activator>
            <Export-Package>${openejb.osgi.export}</Export-Package>
            <Import-Package>${openejb.osgi.import}</Import-Package>
            <Fragment-Host>${openejb.osgi.fragment}</Fragment-Host>
            <Require-Bundle>${openejb.osgi.require}</Require-Bundle>
            <DynamicImport-Package>${openejb.osgi.dynamic.import}</DynamicImport-Package>
            <Private-Package>${openejb.osgi.private.pkg}</Private-Package>
            <Implementation-Title>Apache OpenEJB</Implementation-Title>
            <Implementation-Version>${project.version}</Implementation-Version>
            <Include-Resource>{maven-resources}</Include-Resource>
            <_failok>true</_failok>
            <_nouses>true</_nouses>
          </instructions>
        </configuration>
        <executions>
          <execution>
            <id>bundle-manifest</id>
            <phase>process-classes</phase>
            <goals>
              <goal>manifest</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>

  <properties>
    <openejb.osgi.import.pkg> <!-- don't add * in imports otherwise it will bring back ibm packages! -->
      javax.annotation;version="[1.1.0,2.0.0)",
      javax.annotation.security;version="[1.1.0,2.0.0)",
      javax.annotation.sql;version="[1.1.0,2.0.0)",
      javax.crypto,
      javax.crypto.spec,
      javax.el,
      javax.decorator;resolution:=optional,
      javax.ejb,
      javax.ejb.embeddable,
      javax.ejb.spi,
      javax.enterprise.context,
      javax.enterprise.context.spi,
      javax.enterprise.deploy.model;resolution:=optional,
      javax.enterprise.deploy.shared;resolution:=optional,
      javax.enterprise.deploy.spi;resolution:=optional,
      javax.enterprise.deploy.spi.exceptions;resolution:=optional,
      javax.enterprise.deploy.spi.factories;resolution:=optional,
      javax.enterprise.deploy.spi.status;resolution:=optional,
      javax.enterprise.event,
      javax.enterprise.inject,
      javax.enterprise.inject.spi,
      javax.enterprise.util,
      javax.inject,
      javax.interceptor,
      javax.jms;resolution:=optional,
      javax.jws,
      javax.mail;resolution:=optional;version="[1.4,2)",
      javax.management,
      javax.management.j2ee,
      javax.management.loading,
      javax.management.openmbean,
      javax.naming,
      javax.naming.spi,
      javax.persistence,
      javax.persistence.criteria,
      javax.persistence.metamodel,
      javax.persistence.spi,
      javax.resource,
      javax.resource.spi,
      javax.resource.spi.endpoint,
      javax.resource.spi.work,
      javax.security.auth,
      javax.security.auth.callback,
      javax.security.auth.login,
      javax.security.auth.message.callback,
      javax.security.auth.spi,
      javax.security.jacc,
      javax.servlet,
      javax.servlet.http,
      javax.servlet.jsp,
      javax.sql,
      javax.transaction;version="[1.1.0,2.0.0)",
      javax.transaction.xa;version="[1.1.0,2.0.0)",
      javax.validation,
      javax.validation.bootstrap,
      javax.ws.rs,
      javax.ws.rs.core,
      javax.ws.rs.ext,
      javax.wsdl,
      javax.wsdl.extensions.http,
      javax.wsdl.extensions.soap,
      javax.wsdl.factory,
      javax.wsdl.xml,
      javax.xml.bind,
      javax.xml.bind.annotation,
      javax.xml.bind.annotation.adapters,
      javax.xml.datatype,
      javax.xml.namespace,
      javax.xml.parsers,
      javax.xml.registry;resolution:=optional,
      javax.xml.rpc;resolution:=optional,
      javax.xml.rpc.handler;resolution:=optional,
      javax.xml.transform,
      javax.xml.transform.sax,
      javax.xml.transform.stream,
      javax.xml.validation,
      javax.xml.ws,
      javax.xml.ws.handler,
      javax.xml.ws.soap,
      javax.xml.ws.spi,
      javax.xml.ws.wsaddressing,
      org.apache.activemq.broker;resolution:=optional;version="[5.4,6)",
      org.apache.activemq.ra;resolution:=optional;version="[5.4,6)",
      org.apache.activemq.store;resolution:=optional;version="[5.4,6)",
      org.apache.activemq.store.jdbc;resolution:=optional;version="[5.4,6)",
      org.apache.activemq.store.memory;resolution:=optional;version="[5.4,6)",
      org.apache.bval.jsr303;resolution:=optional,
      org.apache.bval.jsr303.resolver;resolution:=optional,
      org.apache.bval.constraints;resolution:=optional,
      org.apache.commons.beanutils,
      org.apache.commons.cli;version="[1.2,2)",
      org.apache.commons.dbcp;resolution:=optional;version="[1.4,2)",
      org.apache.commons.dbcp.managed;resolution:=optional;version="[1.4,2)",
      org.apache.commons.lang;version="[2.6,3)",
      org.apache.commons.lang.math;version="[2.6,3)",
      org.apache.geronimo.connector;version="[3.0,4)",
      org.apache.geronimo.connector.outbound;version="[3.0,4)",
      org.apache.geronimo.connector.outbound.connectionmanagerconfig;version="[3.0,4)",
      org.apache.geronimo.connector.outbound.connectiontracking;version="[3.0,4)",
      org.apache.geronimo.connector.work;version="[3.0,4)",
      org.apache.geronimo.osgi.locator,
      org.apache.geronimo.transaction.log;version="[3.0,4)";resolution:=optional,,
      org.apache.geronimo.transaction.manager;version="[2.0,4)",
      org.apache.kahadb.util;resolution:=optional;version="[5.4,6)",
      org.apache.log4j;resolution:=optional,
      org.apache.openejb.api;version="[4.0,5)",
      org.apache.openejb.api.jmx;version="[4.0,5)",
      org.apache.openejb.javaagent;version="[4.0,5)",
      org.apache.openejb.jee;version="[4.0,5)",
      org.apache.openejb.jee.bval;version="[4.0,5)",
      org.apache.openejb.jee.jba;version="[4.0,5)",
      org.apache.openejb.jee.jba.cmp;version="[4.0,5)",
      org.apache.openejb.jee.jpa;version="[4.0,5)",
      org.apache.openejb.jee.jpa.unit;version="[4.0,5)",
      org.apache.openejb.jee.oejb2;version="[4.0,5)",
      org.apache.openejb.jee.oejb3;version="[4.0,5)",
      org.apache.openejb.jee.sun;resolution:=optional;version="[4.0,5)",
      org.apache.openejb.jee.wls;version="[4.0,5)",
      org.apache.openejb.loader;version="[4.0,5)",
      org.apache.openejb.client;bundle-version="[4.0,5.0)";resolution:=optional,
      org.apache.openejb.client.proxy;bundle-version="[4.0,5.0)";resolution:=optional,
      org.apache.openejb.client.java;bundle-version="[4.0,5.0)";resolution:=optional,
      org.openejb.client;bundle-version="[4.0,5.0)";resolution:=optional,
      org.apache.openjpa.event;resolution:=optional;version="[2.1,3)",
      org.apache.openjpa.persistence;resolution:=optional;version="[2.1,3)",
      org.apache.webbeans.annotation;version="[1.1,2)",
      org.apache.webbeans.component;version="[1.1,2)",
      org.apache.webbeans.component.creation;version="[1.1,2)",
      org.apache.webbeans.component.third;version="[1.1,2)",
      org.apache.webbeans.config;version="[1.1,2)",
      org.apache.webbeans.container;version="[1.1,2)",
      org.apache.webbeans.context;version="[1.1,2)",
      org.apache.webbeans.context.creational;version="[1.1,2)",
      org.apache.webbeans.conversation;version="[1.1,2)",
      org.apache.webbeans.corespi;version="[1.1,2)",
      org.apache.webbeans.corespi.scanner;version="[1.1,2)",
      org.apache.webbeans.corespi.se;version="[1.1,2)",
      org.apache.webbeans.corespi.security;version="[1.1,2)",
      org.apache.webbeans.decorator;version="[1.1,2)",
      org.apache.webbeans.deployment;version="[1.1,2)",
      org.apache.webbeans.deployment.stereotype;version="[1.1,2)",
      org.apache.webbeans.ee.common.beans;version="[1.1,2)",
      org.apache.webbeans.ee.common.services;version="[1.1,2)",
      org.apache.webbeans.ee.beans;version="[1.1,2)",
      org.apache.webbeans.ee.event;version="[1.1,2)",
      org.apache.webbeans.ejb.common.component;version="[1.0,2)",
      org.apache.webbeans.ejb.common.interceptor;version="[1.0,2)",
      org.apache.webbeans.ejb.common.proxy;version="[1.0,2)",
      org.apache.webbeans.ejb.common.util;version="[1.0,2)",
      org.apache.webbeans.ejb.plugin;version="[1.0,2)",
      org.apache.webbeans.el;version="[1.1,2)",
      org.apache.webbeans.el.el22;version="[1.1,2)",
      org.apache.webbeans.event;version="[1.1,2)",
      org.apache.webbeans.exception;version="[1.1,2)",
      org.apache.webbeans.exception.definition;version="[1.1,2)",
      org.apache.webbeans.exception.helper;version="[1.1,2)",
      org.apache.webbeans.exception.inject;version="[1.1,2)",
      org.apache.webbeans.inject;version="[1.1,2)",
      org.apache.webbeans.inject.impl;version="[1.1,2)",
      org.apache.webbeans.inject.instance;version="[1.1,2)",
      org.apache.webbeans.intercept;version="[1.1,2)",
      org.apache.webbeans.intercept.custom;version="[1.1,2)",
      org.apache.webbeans.intercept.ejb;version="[1.1,2)",
      org.apache.webbeans.intercept.webbeans;version="[1.1,2)",
      org.apache.webbeans.jms;version="[1.1,2)",
      org.apache.webbeans.lifecycle;version="[1.1,2)",
      org.apache.webbeans.logger;version="[1.1,2)",
      org.apache.webbeans.plugins;version="[1.1,2)",
      org.apache.webbeans.portable;version="[1.1,2)",
      org.apache.webbeans.portable.creation;version="[1.1,2)",
      org.apache.webbeans.portable.events;version="[1.1,2)",
      org.apache.webbeans.portable.events.discovery;version="[1.1,2)",
      org.apache.webbeans.portable.events.generics;version="[1.1,2)",
      org.apache.webbeans.proxy;version="[1.1,2)",
      org.apache.webbeans.proxy.asm;version="[1.1,2)",
      org.apache.webbeans.proxy.javassist;version="[1.1,2)",
      org.apache.webbeans.service;version="[1.1,2)",
      org.apache.webbeans.servlet;version="[1.1,2)",
      org.apache.webbeans.spi;version="[1.1,2)",
      org.apache.webbeans.spi.adaptor;version="[1.1,2)",
      org.apache.webbeans.spi.api;version="[1.1,2)",
      org.apache.webbeans.spi.plugins;version="[1.1,2)",
      org.apache.webbeans.util;version="[1.1,2)",
      org.apache.webbeans.web.context;version="[1.1,2)",
      org.apache.webbeans.web.failover;version="[1.1,2)",
      org.apache.webbeans.web.intercept;version="[1.1,2)",
      org.apache.webbeans.web.lifecycle;version="[1.1,2)",
      org.apache.webbeans.web.scanner;version="[1.1,2)",
      org.apache.webbeans.web.util;version="[1.1,2)",
      org.apache.webbeans.xml;version="[1.1,2)",
      org.apache.xbean.asm;version="[3.1,4)",
      org.apache.xbean.asm.commons;version="[3.1,4)",
      org.apache.xbean.finder;version="[3.8,4)",
      org.apache.xbean.finder.archive;version="[3.8,4)",
      org.apache.xbean.finder.filter;version="[3.8,4)",
      org.apache.xbean.naming.context;version="[3.8,4)",
      org.apache.xbean.naming.reference;version="[3.8,4)",
      org.apache.xbean.propertyeditor;version="[3.8,4)",
      org.apache.xbean.recipe;version="[3.8,4)",
      org.hsqldb.jdbc;resolution:=optional,
      org.junit.rules;resolution:=optional,
      org.junit.runners;resolution:=optional,
      org.junit.runners.model;resolution:=optional,
      org.testng;resolution:=optional,
      org.omg.CORBA,
      org.quartz;resolution:=optional,
      org.quartz.impl;resolution:=optional,
      org.quartz.spi;resolution:=optional,
      org.slf4j;resolution:=optional;version="[1.6,4)",
      org.slf4j.helpers;resolution:=optional;version="[1.6,4)",
      org.slf4j.spi;resolution:=optional;version="[1.6,4)",
      org.slf4j.impl;resolution:=optional;version="[1.6,4)",
      org.w3c.dom,
      org.w3c.dom.ls,
      org.xml.sax,
      org.xml.sax.helpers,
      org.osgi.service.packageadmin,
      org.osgi.framework;version="[1.4,2)",
      org.osgi.util.tracker;version="[1.4,2)",
      javassist.util;resolution:=optional;version="[3.9,4)",
      javassist.util.proxy;resolution:=optional;version="[3.9,4)",
      org.osgi.service.blueprint;resolution:=optional
    </openejb.osgi.import.pkg>
    <openejb.osgi.export>
      '=META-INF.org^.apache^.openejb',
      org.apache.openejb;version=${openejb.osgi.export.version},
      org.apache.openejb.api.internal;version=${openejb.osgi.export.version},
      org.apache.openejb.async;version=${openejb.osgi.export.version},
      org.apache.openejb.assembler;version=${openejb.osgi.export.version},
      org.apache.openejb.assembler.classic;version=${openejb.osgi.export.version},
      org.apache.openejb.assembler.classic.cmd;version=${openejb.osgi.export.version},
      org.apache.openejb.assembler.classic.assembler;version=${openejb.osgi.export.version},
      org.apache.openejb.assembler.classic.util;version=${openejb.osgi.export.version},
      org.apache.openejb.assembler.dynamic;version=${openejb.osgi.export.version},
      org.apache.openejb.assembler.bval;version=${openejb.osgi.export.version},
      org.apache.openejb.assembler.monitoring;version=${openejb.osgi.export.version},
      org.apache.openejb.bval;version=${openejb.osgi.export.version},
      org.apache.openejb.cdi;version=${openejb.osgi.export.version},
      org.apache.openejb.cli;version=${openejb.osgi.export.version},
      org.apache.openejb.config;version=${openejb.osgi.export.version},
      org.apache.openejb.config.rules;version=${openejb.osgi.export.version},
      org.apache.openejb.config.sys;version=${openejb.osgi.export.version},
      org.apache.openejb.core;version=${openejb.osgi.export.version},
      org.apache.openejb.assembler.classic.event;version=${openejb.osgi.export.version},
      org.apache.openejb.classloader;version=${openejb.osgi.export.version},
      org.apache.openejb.core.asynch;version=${openejb.osgi.export.version},
      org.apache.openejb.core.cmp;version=${openejb.osgi.export.version},
      org.apache.openejb.core.cmp.cmp2;version=${openejb.osgi.export.version},
      org.apache.openejb.core.cmp.jpa;version=${openejb.osgi.export.version},
      org.apache.openejb.core.entity;version=${openejb.osgi.export.version},
      org.apache.openejb.core.interceptor;version=${openejb.osgi.export.version},
      org.apache.openejb.core.ivm;version=${openejb.osgi.export.version},
      org.apache.openejb.core.ivm.naming;version=${openejb.osgi.export.version},
      org.apache.openejb.core.ivm.naming.java;version=${openejb.osgi.export.version},
      org.apache.openejb.core.ivm.naming.openejb;version=${openejb.osgi.export.version},
      org.apache.openejb.core.managed;version=${openejb.osgi.export.version},
      org.apache.openejb.core.mdb;version=${openejb.osgi.export.version},
      org.apache.openejb.core.security;version=${openejb.osgi.export.version},
      org.apache.openejb.core.security.jaas;version=${openejb.osgi.export.version},
      org.apache.openejb.core.security.jacc;version=${openejb.osgi.export.version},
      org.apache.openejb.core.singleton;version=${openejb.osgi.export.version},
      org.apache.openejb.core.stateful;version=${openejb.osgi.export.version},
      org.apache.openejb.core.stateless;version=${openejb.osgi.export.version},
      org.apache.openejb.core.timer;version=${openejb.osgi.export.version},
      org.apache.openejb.core.transaction;version=${openejb.osgi.export.version},
      org.apache.openejb.core.webservices;version=${openejb.osgi.export.version},
      org.apache.openejb.junit;version=${openejb.osgi.export.version},
      org.apache.openejb.jpa.integraton;version=${openejb.osgi.export.version},
      org.apache.openejb.jpa.integraton.hibernate;version=${openejb.osgi.export.version},
      org.apache.openejb.jpa.integraton.eclipselink;version=${openejb.osgi.export.version},
      org.apache.openejb.hibernate;version=${openejb.osgi.export.version},
      org.apache.openejb.eclipselink;version=${openejb.osgi.export.version},
      org.apache.openejb.math;version=${openejb.osgi.export.version},
      org.apache.openejb.math.stat;version=${openejb.osgi.export.version},
      org.apache.openejb.math.stat.descriptive;version=${openejb.osgi.export.version},
      org.apache.openejb.math.stat.descriptive.moment;version=${openejb.osgi.export.version},
      org.apache.openejb.math.stat.descriptive.rank;version=${openejb.osgi.export.version},
      org.apache.openejb.math.stat.descriptive.summary;version=${openejb.osgi.export.version},
      org.apache.openejb.math.util;version=${openejb.osgi.export.version},
      org.apache.openejb.mgmt;version=${openejb.osgi.export.version},
      org.apache.openejb.monitoring;version=${openejb.osgi.export.version},
      org.apache.openejb.osgi;version=${openejb.osgi.export.version},
      org.apache.openejb.osgi.client;version=${openejb.osgi.export.version},
      org.apache.openejb.table;version=${openejb.osgi.export.version},
      org.apache.openejb.util.helper;version=${openejb.osgi.export.version},
      org.apache.openejb.persistence;version=${openejb.osgi.export.version},
      org.apache.openejb.resource;version=${openejb.osgi.export.version},
      org.apache.openejb.resource.activemq;version=${openejb.osgi.export.version},
      org.apache.openejb.resource.jdbc;version=${openejb.osgi.export.version},
      org.apache.openejb.resource.quartz;version=${openejb.osgi.export.version},
      org.apache.openejb.rest;version=${openejb.osgi.export.version},
      org.apache.openejb.ri;version=${openejb.osgi.export.version},
      org.apache.openejb.ri.sp;version=${openejb.osgi.export.version},
      org.apache.openejb.spi;version=${openejb.osgi.export.version},
      org.apache.openejb.util;version=${openejb.osgi.export.version},
      org.apache.openejb.util.classloader;version=${openejb.osgi.export.version},
      org.apache.openejb.util.proxy;version=${openejb.osgi.export.version},
      org.apache.openejb.util.reflection;version=${openejb.osgi.export.version},
      org.apache.openejb.util.urlhandler;version=${openejb.osgi.export.version},
      org.apache.openejb.core.osgi.*;version=${openejb.osgi.export.version}
    </openejb.osgi.export>
    <openejb.bundle.activator>org.apache.openejb.core.osgi.impl.Activator</openejb.bundle.activator>
    <openejb.osgi.dynamic.import.pkg>*</openejb.osgi.dynamic.import.pkg>
  </properties>
</project>
